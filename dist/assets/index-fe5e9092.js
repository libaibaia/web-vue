import{b as K,T as q,a as D}from"./index-6f00a71d.js";import{b as $,w as E,g as G,h as H}from"./index-0c819fdc.js";import{b as _}from"./controllerUrls-beb409f8.js";import M from"./popupForm-9a4e8330.js";import{c as g}from"./IRequests-783be2cd.js";import{h as C,K as k,r as T,a9 as z,z as Q,p as b,l as I,k as v,B as w,S as X,q as o,C as s,o as j,T as x,Q as J,R as W,ak as Y,t as i,X as Z}from"./vue-a98ef309.js";import"./baAccount-2dad18d3.js";import"./index-03bd2479.js";const ee={class:"default-main ba-table-box"},te={class:"dialog-footer"},le=C({name:"auth/group"}),me=C({...le,setup(ae){const V=k(),h=k(),{t:B}=$(),p=k(!1);let S={render:"tipButton",name:"restart",title:"重新检测",type:"primary",icon:"el-icon-RefreshLeft",class:"table-row-edit",disabledTip:!1,click:(t,l)=>{d.akId=t.id,P()}};const u=T({lists:[]});let L={render:"tipButton",name:"restart",title:"列出权限列表",type:"primary",icon:"el-icon-ChatLineSquare",class:"table-row-edit",disabledTip:!1,click:(t,l)=>{d.akId=t.id,N()}},A={render:"tipButton",name:"createConsoleUser",title:"创建控制台用户",type:"primary",icon:"el-icon-Plus",class:"table-row-edit",disabledTip:!1,click:(t,l)=>{d.akId=t.id,U()}};const d=T({akId:""}),P=()=>{g(_+"restart","POST",{id:d.akId}).then(t=>{})},U=()=>{g("api/console/binduser","POST",{id:d.akId}).then(t=>{})},N=()=>{g(_+"perm","POST",{id:d.akId}).then(t=>{u.lists=t.lists,u.lists.length<=0?Y.warning("策略列表为空"):(p.value=!0,console.log(u.lists))})};let m=E(["edit","delete"]);m.push(S),m.push(A),m.push(L);const e=new K(new G(_),{expandAll:!0,dblClickNotEditColumn:[void 0],column:[{type:"selection",align:"center"},{label:"名称",prop:"name",align:"center"},{label:"SecretId",prop:"secretid",align:"center",width:"230"},{label:"SecretKey",prop:"secretkey",align:"center",width:"270"},{label:"厂商",prop:"type",align:"center",width:"160"},{label:"token",prop:"token",align:"center",width:"160"},{label:"任务状态",prop:"taskStatus",align:"center",width:"200"},{label:"创建时间",prop:"createTime",align:"center"},{label:"更新时间",prop:"updateTime",align:"center"},{label:"描述",prop:"remark",align:"center"},{label:B("operate"),align:"center",render:"buttons",buttons:m}]},{},{onSubmit:({formEl:t,items:a})=>{var a=z(a);for(const r in a)a[r]===null&&delete a[r];let c=()=>{e.form.submitLoading=!0,e.api.postData(e.form.operate,a).then(r=>{var f;e.onTableHeaderAction("refresh",{}),e.form.submitLoading=!1,(f=e.form.operateIds)==null||f.shift(),e.form.operateIds.length>0?e.toggleForm("edit",e.form.operateIds):e.toggleForm(),e.runAfter("onSubmit",{res:r})}).catch(()=>{e.form.submitLoading=!1})};return t?(e.form.ref=t,t.validate(r=>{r&&c()})):c(),!1},onTableDblclick:({row:t})=>e.table.extend.adminGroup.indexOf(t.id)===-1},{getIndex:({res:t})=>{e.table.extend.adminGroup=t.lists;let l=H(e.table.column,"render","buttons");e.table.column[l].buttons.forEach(a=>{a.display=c=>t.lists.indexOf(c.id)===-1})}});return Z("baTable",e),Q(()=>{e.table.ref=h.value,e.mount(),e.getIndex()}),(t,l)=>{const a=i("el-alert"),c=i("el-input"),r=i("el-form-item"),f=i("el-form"),O=i("el-scrollbar"),y=i("el-button"),R=i("el-dialog");return b(),I("div",ee,[v(e).table.remark?(b(),w(a,{key:0,class:"ba-table-alert",title:v(e).table.remark,type:"info","show-icon":""},null,8,["title"])):X("",!0),o(q,{buttons:["refresh","add","edit","delete","stopAllTask","start"],"quick-search-placeholder":"搜索"}),o(D,{ref_key:"tableRef",ref:h,pagination:"true"},null,512),o(M,{ref_key:"formRef",ref:V},null,512),o(R,{modelValue:p.value,"onUpdate:modelValue":l[2]||(l[2]=n=>p.value=n),title:"权限列表",width:"30%"},{footer:s(()=>[j("span",te,[o(y,{onClick:l[0]||(l[0]=n=>p.value=!1)},{default:s(()=>[x("Cancel")]),_:1}),o(y,{type:"primary",onClick:l[1]||(l[1]=n=>p.value=!1)},{default:s(()=>[x(" 确认 ")]),_:1})])]),default:s(()=>[o(O,{height:"400px"},{default:s(()=>[(b(!0),I(J,null,W(u.lists,(n,oe)=>(b(),w(f,null,{default:s(()=>[o(r,{label:n.policyName},{default:s(()=>[o(c,{modelValue:n.remark,"onUpdate:modelValue":F=>n.remark=F,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])]),_:2},1024))),256))]),_:1})]),_:1},8,["modelValue"])])}}});export{me as default};
