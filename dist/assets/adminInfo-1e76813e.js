import{h as P,K as M,r as y,p as U,l as R,q as n,C as i,o as u,U as c,k as l,B as z,N as v,M as x,T as L,ar as A,t as r}from"./vue-a98ef309.js";import{f as V,b as j,a as q,c as C,U as E,y as G,_ as H}from"./index-0c819fdc.js";import{b as I}from"./validate-594baa03.js";const h="/api/user/",k=new Map([["index",h+"userInfo"],["edit",h+"edit"],["log",h+"log"]]);function J(){return V({url:k.get("index"),method:"get"})}function O(g={}){return V({url:k.get("log"),method:"get",params:g})}function F(g){return V({url:k.get("edit"),method:"post",data:g},{showSuccessMessage:!0})}const Q={class:"default-main"},W={class:"admin-info"},X={class:"image-slot"},Y={class:"admin-info-base"},Z={class:"admin-nike"},ee={class:"admin-other"},oe={class:"admin-info-form"},ae=P({name:"routine/adminInfo"}),ne=P({...ae,setup(g){const{t:a}=j(),p=M(),_=q(),e=y({adminInfo:{},formKey:C(),buttonLoading:!1,log:[],logFilter:{limit:12},logCurrentPage:1,logPageSize:12,logTotal:100,logLoading:!0});J().then(d=>{console.log(d.info),console.log(e.adminInfo),e.adminInfo=d.info,e.formKey=C(),e.logFilter.search=[{field:"admin_id",val:d.data.info.id,operator:"="}],K()});const K=()=>{O(e.logFilter).then(d=>{e.log=d.data.list,e.logTotal=d.data.total,e.logLoading=!1}).catch(()=>{e.logLoading=!1})},B=y({nike:[I({name:"required",title:a("routine.adminInfo.User nike")})],email:[I({name:"email",title:a("routine.adminInfo.e-mail address")})],mobile:[I({name:"mobile",message:a("Please enter the correct field",{field:a("routine.adminInfo.phone number")})})],password:[I({name:"password"})]}),S=d=>{let o=new FormData;o.append("file",d.raw),G(o).then(s=>{s.code==1&&F({id:e.adminInfo.id,avatar:s.data.file.url}).then(()=>{_.dataFill({..._.$state,avatar:s.data.file.full_url}),e.adminInfo.avatar=s.data.file.full_url})})},b=d=>{d&&d.validate(o=>{if(o){let s={...e.adminInfo};delete s.lastlogintime,delete s.username,delete s.avatar,e.buttonLoading=!0,F(s).then(()=>{_.dataFill({..._.$state,nike:e.adminInfo.nike}),e.buttonLoading=!1}).catch(()=>{e.buttonLoading=!1})}})};return(d,o)=>{const s=r("Icon"),$=r("el-image"),N=r("el-upload"),f=r("el-input"),m=r("el-form-item"),w=r("el-button"),T=r("el-col"),D=r("el-row");return U(),R("div",Q,[n(D,{gutter:30},{default:i(()=>[n(T,{class:"lg-mb-20",xs:24,sm:24,md:24,lg:10},{default:i(()=>[u("div",W,[n(N,{class:"avatar-uploader",action:"","show-file-list":!1,onChange:S,"auto-upload":!1,accept:"image/gif, image/jpg, image/jpeg, image/bmp, image/png, image/webp"},{default:i(()=>[n($,{src:e.adminInfo.avatar,class:"avatar"},{error:i(()=>[u("div",X,[n(s,{size:"30",color:"#c0c4cc",name:"el-icon-Picture"})])]),_:1},8,["src"])]),_:1}),u("div",Y,[u("div",Z,c(e.adminInfo.nike),1),u("div",ee,[u("div",null,c(l(a)("routine.adminInfo.Last logged in on"))+" "+c(e.adminInfo.lastlogintime),1)])]),u("div",oe,[(U(),z(l(A),{onKeyup:o[10]||(o[10]=v(t=>b(p.value),["enter"])),key:e.formKey,"label-position":"top",rules:B,ref_key:"formRef",ref:p,model:e.adminInfo},{default:i(()=>[n(m,{label:l(a)("routine.adminInfo.user name")},{default:i(()=>[n(f,{disabled:"",modelValue:e.adminInfo.username,"onUpdate:modelValue":o[0]||(o[0]=t=>e.adminInfo.username=t)},null,8,["modelValue"])]),_:1},8,["label"]),n(m,{label:l(a)("routine.adminInfo.User nike"),prop:"nike"},{default:i(()=>[n(f,{placeholder:l(a)("routine.adminInfo.Please enter a nike"),modelValue:e.adminInfo.nike,"onUpdate:modelValue":o[1]||(o[1]=t=>e.adminInfo.nike=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(m,{label:l(a)("routine.adminInfo.e-mail address"),prop:"email"},{default:i(()=>[n(f,{placeholder:l(a)("Please input field",{field:l(a)("routine.adminInfo.e-mail address")}),modelValue:e.adminInfo.email,"onUpdate:modelValue":o[2]||(o[2]=t=>e.adminInfo.email=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(m,{label:l(a)("routine.adminInfo.phone number"),prop:"mobile"},{default:i(()=>[n(f,{placeholder:l(a)("Please input field",{field:l(a)("routine.adminInfo.phone number")}),modelValue:e.adminInfo.mobile,"onUpdate:modelValue":o[3]||(o[3]=t=>e.adminInfo.mobile=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(m,{label:l(a)("routine.adminInfo.autograph"),prop:"motto"},{default:i(()=>[n(f,{onKeyup:[o[4]||(o[4]=v(x(()=>{},["stop"]),["enter"])),o[5]||(o[5]=v(x(t=>b(p.value),["ctrl"]),["enter"]))],placeholder:l(a)("routine.adminInfo.This guy is lazy and doesn write anything"),type:"textarea",modelValue:e.adminInfo.motto,"onUpdate:modelValue":o[6]||(o[6]=t=>e.adminInfo.motto=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(m,{label:l(a)("routine.adminInfo.New password"),prop:"password"},{default:i(()=>[n(f,{type:"password",placeholder:l(a)("routine.adminInfo.Please leave blank if not modified"),modelValue:e.adminInfo.password,"onUpdate:modelValue":o[7]||(o[7]=t=>e.adminInfo.password=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),n(m,null,{default:i(()=>[n(w,{type:"primary",loading:e.buttonLoading,onClick:o[8]||(o[8]=t=>b(p.value))},{default:i(()=>[L(c(l(a)("routine.adminInfo.Save changes")),1)]),_:1},8,["loading"]),n(w,{onClick:o[9]||(o[9]=t=>l(E)(p.value))},{default:i(()=>[L(c(l(a)("Reset")),1)]),_:1})]),_:1})]),_:1},8,["rules","model"]))])])]),_:1})]),_:1})])}}});const de=H(ne,[["__scopeId","data-v-10e89b57"]]);export{de as default};
